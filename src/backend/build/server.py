"""MCP server for calculating the greatest common divisor (GCD) of two numbers
Generated by mcpgen. Server: gcd-calculator
"""
from __future__ import annotations
from typing import Any, List, Dict, Optional
from mcp.server.fastmcp import FastMCP

mcp = FastMCP("gcd-calculator", log_level="ERROR")



@mcp.tool()
def find_gcd(a: int = None, b: int = None) -> int:
    """Calculate the greatest common divisor (GCD) of two integers using Euclidean algorithm"""
    # Handle negative numbers by taking absolute values
    a = abs(a)
    b = abs(b)
    
    # Euclidean algorithm
    while b != 0:
        temp = b
        b = a % b
        a = temp
    
    return a

@mcp.tool()
def find_gcd_multiple(numbers: list[int] = None) -> int:
    """Calculate the GCD of multiple integers"""
    if not numbers:
        raise ValueError("List cannot be empty")
    
    if len(numbers) == 1:
        return abs(numbers[0])
    
    # Helper function for two numbers
    def gcd_two(a: int, b: int) -> int:
        a = abs(a)
        b = abs(b)
        while b != 0:
            temp = b
            b = a % b
            a = temp
        return a
    
    # Calculate GCD iteratively for all numbers
    result = numbers[0]
    for i in range(1, len(numbers)):
        result = gcd_two(result, numbers[i])
        if result == 1:
            break  # Early exit if GCD becomes 1
    
    return result


class GeneratedToolset:
    """Expose generated MCP tools as bound methods that can be iterated over."""
    _tool_names = ('find_gcd', 'find_gcd_multiple')

    def __iter__(self):
        for tool_name in self._tool_names:
            yield getattr(self, tool_name)

    def find_gcd(self, a: int = None, b: int = None) -> int:
        return find_gcd(a, b)

    def find_gcd_multiple(self, numbers: list[int] = None) -> int:
        return find_gcd_multiple(numbers)


if __name__ == "__main__":
    # stdio transport for agent runtimes
    mcp.run()